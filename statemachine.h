#ifndef STATEMACHINE_H
#define STATEMACHINE_H

#include <stdio.h>
#include "cache.h"
#include "print.h"


// Comment this line to disable print statements
#define PRINT


/******************************************************************************************************
 * Define states used in the state machine
 ******************************************************************************************************/
#define IDLE                        0
#define QUERY_L1                    1
#define QUERY_L2                    2
#define ADD_L1                      3
#define ADD_L2                      4
#define HANDLE_WRITE                5
#define FLUSH                       6


/******************************************************************************************************
 * Makes call to state machine
 ******************************************************************************************************/
void stateMachine( struct reference* ref );


/******************************************************************************************************
 * Selects correct L1 cache based on reference type
 ******************************************************************************************************/
struct cache cacheType( struct reference* ref );


/******************************************************************************************************
 * Access L1 cache to get reference
 ******************************************************************************************************/
int queryL1( struct reference* ref, struct cache* cache );


/******************************************************************************************************
 * Access L2 cache to get reference
 ******************************************************************************************************/
int queryL2( struct reference* ref );


/******************************************************************************************************
 * Add tag to L1 cache
 ******************************************************************************************************/
int addL1( struct reference* ref, struct cache* cache );


/******************************************************************************************************
 * Add tag to L2 cache
 ******************************************************************************************************/
int addL2( struct reference* ref );


/******************************************************************************************************
 * Set the dirty bit of tag in L1 cache
 ******************************************************************************************************/
int handleWrite( struct reference* ref, struct cache* cache );


/******************************************************************************************************
 * Flush the cache by invalidating all of the data
 ******************************************************************************************************/
// int handleWrite( struct reference* ref, struct cache* cache );


#endif // STATEMACHINE_H
